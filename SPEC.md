# Baseball Report - 기능명세서 (SPEC)

## 📖 프로젝트 개요

### 목적
야구경기에서 투수가 던진 공의 정보(스트라이크, 볼, 위치, 속도 등)를 기록하고, 경기별 성적을 분석하는 웹 기반 분석 시스템입니다. 투수의 효율성과 특징을 파악할 수 있도록 설계되었습니다.

### 대상 사용자
- 야구 코치 및 투수 (경기 분석 및 개선점 파악)
- 야구 팬 (선수 성적 추적)
- 야구 기자 및 분석가 (통계 데이터 수집)

### 개발 환경
- **언어**: Python 3.8+
- **프레임워크**: Streamlit 1.28.0+
- **배포 환경**: Streamlit Cloud, 로컬 실행

---

## 🎯 주요 기능 목록

### 1️⃣ TAB 1: 새로운 경기 기록 (`📝 new_game`)

#### 기능 상세

**경기 기본 정보 입력**
- 📅 경기 날짜 (`game_date`) - 날짜 선택 위젯, 기본값: 오늘 날짜
- 👤 투수 이름 (`pitcher_name`) - 텍스트 입력, 필수 입력값
- 🏟️ 상대팀 (`opponent`) - 텍스트 입력, 필수 입력값
- ⏱️ 이닝 (`inning`) - 숫자 입력 (1-9), 기본값: 1

**투구 기록 입력**
- 🎯 공의 종류 (`pitch_type`) - 선택 박스
  * Fast Ball, Curveball, Slider, Changeup, Sinker, 기타
- 📊 결과 (`result`) - 선택 박스
  * ⚾ Strike, ⚾ Ball, 🎯 Strike Out, 🏃 Hit, 기타
- 📍 위치 (`location`) - 선택 박스 (9개 Zone + 기타)
  * 🎯 Center (중앙)
  * ⬆️ High (상단), ⬇️ Low (하단)
  * ⬅️ Inside (안쪽), ➡️ Outside (바깥쪽)
  * 대각선 조합 (HighInside, HighOutside 등)
- ⚡ 투구 속도 (`speed`) - 숫자 입력, 범위: 80-160 km/h
- 📝 메모 (`notes`) - 텍스트 입력, 선택사항

**저장 기능**
- "💾 투구 기록 저장" 버튼 클릭 시:
  1. 기존 경기 확인 (투수명 + 날짜로 고유 키 생성)
  2. 새 경기면 생성, 기존 경기면 추가
  3. 투구 정보를 `pitches` 배열에 추가
  4. `game_records.json`에 저장
  5. ✅ 성공 메시지 + 풍선 효과 표시

---

### 2️⃣ TAB 2: 성적 조회 (`📊 View Stats`)

#### 기능 상세

**경기 선택**
- 저장된 모든 경기 목록 표시 (투수명 + 상대팀 + 날짜)
- 드롭다운으로 경기 선택

**경기별 주요 통계**
- ⚾ 총 투구수
- ✅ 스트라이크 (Strike 포함 결과)
- ❌ 볼 (Ball 포함 결과)
- 📊 스트라이크율 (%)

**투구 상세 기록**
- 각 투구를 Expander로 표시
- 투구 #번호 - 결과 (공의 종류) 형식
- 클릭 시 상세 정보 표시:
  * 이닝, 공의 종류, 결과, 위치, 투구 속도, 메모

**경기 삭제 기능**
- "🗑️ 이 경기 기록 삭제" 버튼
- 선택된 경기 삭제 후 페이지 새로고침

---

### 3️⃣ TAB 3: 성적 분석 (`📈 Analysis`)

#### 기능 상세

**투수별 통합 통계**
- 경기수 (games)
- 총 투구수 (total_pitches)
- 스트라이크 수 (strikes)
- 볼 수 (balls)
- 평균 투구 속도 (avg_speed)

**시각화**
1. **공의 종류 분포** - 막대 그래프
   - 각 공 종류별 투구 횟수
   - 투수의 선호 공 타입 파악

2. **위치 분포** - 막대 그래프
   - 각 위치별 투구 횟수
   - 투수의 컨트롤 패턴 파악

---

## 📝 사용자 입력 항목 및 유효성 검증

| 항목 | 타입 | 필수 | 범위/형식 | 검증 내용 |
|------|------|------|----------|----------|
| 경기 날짜 | 날짜 | O | - | 과거 또는 현재 날짜만 허용 |
| 투수 이름 | 텍스트 | O | 1-50자 | 빈 값 방지 |
| 상대팀 | 텍스트 | O | 1-50자 | 빈 값 방지 |
| 이닝 | 숫자 | O | 1-9 | 범위 외 값 자동 조정 |
| 공의 종류 | 선택 | O | 6개 옵션 | 사전 정의된 값만 허용 |
| 결과 | 선택 | O | 5개 옵션 | 사전 정의된 값만 허용 |
| 위치 | 선택 | O | 10개 옵션 | 사전 정의된 값만 허용 |
| 투구 속도 | 숫자 | O | 80-160 | 범위 외 값 자동 조정 |
| 메모 | 텍스트 | X | 0-200자 | 빈 값 허용 |

---

## 💾 데이터 처리 방식

### 저장 구조

```json
{
  "games": [
    {
      "game_key": "투수명_날짜",
      "date": "YYYY-MM-DD",
      "pitcher": "투수명",
      "opponent": "상대팀",
      "pitches": [
        {
          "inning": 1,
          "type": "Fast Ball",
          "result": "⚾ Strike",
          "location": "🎯 Center",
          "speed": 145,
          "notes": "좋은 컨트롤",
          "timestamp": "ISO 8601 형식"
        }
      ]
    }
  ]
}
```

### 저장 위치
- 파일명: `game_records.json`
- 위치: 프로젝트 루트 디렉토리
- 인코딩: UTF-8

### 데이터 로드/저장 함수
- `load_data()`: JSON 파일에서 데이터 로드
- `save_data(data)`: 데이터를 JSON 파일에 저장

---

## 🚨 예외 처리 내용

### 에러 메시지 및 처리

| 상황 | 메시지 | 처리 방법 |
|------|--------|----------|
| 경기 기록 없음 | "📭 저장된 경기 기록이 없습니다" | 새 경기 기록 안내 |
| 분석 데이터 없음 | "📭 분석할 데이터가 없습니다" | 경기 기록 추가 안내 |
| 파일 읽기 실패 | 자동 복구 (빈 데이터 사용) | 새로운 game_records.json 생성 |
| 잘못된 JSON | 자동 복구 (빈 데이터 사용) | 파일 재작성 |

### 성공 피드백
- ✅ "투구 기록이 저장되었습니다!" - 저장 성공
- ✅ 풍선 🎈 효과 - 시각적 피드백
- ⚠️ "경기 기록이 삭제되었습니다!" - 삭제 성공

---

## 📦 배포 환경 요구사항

### 최소 요구사항
- **Python**: 3.8 이상
- **메모리**: 512MB 이상
- **저장소**: 100MB 이상 (game_records.json 저장)

### 필수 패키지
```
streamlit>=1.28.0
pandas>=2.0.0
numpy>=1.24.0
python-dotenv>=1.0.0
pytz>=2023.3
requests>=2.31.0
```

### 배포 방법

#### 로컬 실행
```bash
pip install -r requirements.txt
streamlit run app.py
```

#### Streamlit Cloud 배포
1. GitHub에 코드 푸시
2. [Streamlit Cloud](https://share.streamlit.io) 가입
3. "New app" → GitHub 저장소 선택
4. 앱 자동 배포

---

## 📸 향후 스크린샷 추가 위치

다음 섹션에 스크린샷을 추가할 계획입니다:

### 1. TAB 1: 새로운 경기 기록
- [ ] 경기 정보 입력 폼
- [ ] 투구 기록 입력 폼
- [ ] 저장 성공 메시지

### 2. TAB 2: 성적 조회
- [ ] 경기 선택 드롭다운
- [ ] 통계 메트릭 표시
- [ ] 투구 상세 기록 (Expander)

### 3. TAB 3: 성적 분석
- [ ] 투수별 통계
- [ ] 공의 종류 분포 그래프
- [ ] 위치 분포 그래프

---

## 🔐 보안 정보

### 민감 정보 처리
- **현재 상태**: 민감 정보 없음 (API 키, 토큰 포함 X)
- **데이터 저장**: 로컬 JSON 파일 (암호화 X)
- **.gitignore**: game_records.json 제외 설정 완료

### 향후 개선사항
인증, 데이터베이스 연동 등 추가 시 다음을 고려:
- `.env` 파일로 민감 정보 분리
- `python-dotenv` 사용으로 환경 변수 관리
- Streamlit Cloud의 Secrets 탭 활용

---

## 📞 연락처 및 지원

- **GitHub**: https://github.com/simba0801/Baseball-report2
- **작성자**: 개발팀
- **최종 수정**: 2026-02-13
